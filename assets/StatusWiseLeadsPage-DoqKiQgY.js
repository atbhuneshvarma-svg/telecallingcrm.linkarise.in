import{ac as D,r as u,j as e,q as E,aC as P,aE as v,aG as w,aH as $,aF as C}from"./index-BJcvY-Fc.js";const z="https://leadzcrm.linkarise.in/api",W=async a=>{try{const l=new FormData;return a.leadmids.forEach((i,r)=>{l.append(`leadmids[${r}]`,i.toString())}),a.page&&l.append("page",a.page.toString()),a.per_page&&l.append("per_page",a.per_page.toString()),a.search&&l.append("search",a.search),a.campaign&&l.append("campaign",a.campaign),a.telecaller&&l.append("telecaller",a.telecaller),a.statusname&&l.append("statusname",a.statusname),(await D.post(`${z}/lead/statuswise`,l,{headers:{"Content-Type":"multipart/form-data"}})).data}catch(l){throw console.error("Error fetching status wise leads:",l),l}},F=(a,l=!0)=>{const[n,i]=u.useState([]),[r,d]=u.useState(!1),[m,t]=u.useState(null),[b,o]=u.useState({current_page:1,per_page:10,total:0,from:0,to:0,total_pages:1}),p=u.useCallback(async()=>{if(a.leadmids.length===0){i([]);return}d(!0),t(null);try{const s=await W(a);s.status&&s.data?(i(s.data.data),o({current_page:s.data.current_page,per_page:s.data.per_page,total:s.data.total,from:s.data.from,to:s.data.to,total_pages:s.data.last_page})):i([])}catch(s){console.error("Error in useStatusWiseLeads:",s),t(s instanceof Error?s:new Error("Failed to fetch leads")),i([])}finally{d(!1)}},[a]);return u.useEffect(()=>{l&&p()},[p,l]),{leads:n,isLoading:r,error:m,pagination:b,refetch:p}},L=({filters:a,filterOptions:l,dateRange:n,onFilterChange:i,onDateChange:r,onApplyFilters:d,onResetFilters:m})=>e.jsx("div",{className:"row mb-4",children:e.jsx("div",{className:"col-md-12",children:e.jsxs("div",{className:"row g-3",children:[e.jsx("div",{className:"col-12",children:e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-md-3",children:e.jsx("label",{className:"form-label",style:{fontSize:"14px",fontWeight:"500",color:"#666"},children:"Select Date"})}),e.jsx("div",{className:"col-md-3",children:e.jsx("label",{className:"form-label",style:{fontSize:"14px",fontWeight:"500",color:"#666"},children:"Select Campaign"})}),e.jsx("div",{className:"col-md-3",children:e.jsx("label",{className:"form-label",style:{fontSize:"14px",fontWeight:"500",color:"#666"},children:"Select User"})}),e.jsx("div",{className:"col-md-3",children:e.jsx("label",{className:"form-label",style:{fontSize:"14px",fontWeight:"500",color:"#666"},children:"Select Status"})})]})}),e.jsx("div",{className:"col-12",children:e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-md-3",children:e.jsxs("div",{className:"input-group",children:[e.jsx("input",{type:"date",className:"form-control",value:a.date_from,onChange:t=>i({...a,date_from:t.target.value}),style:{height:"38px",fontSize:"14px"}}),e.jsx("span",{className:"input-group-text",style:{fontSize:"14px"},children:"to"}),e.jsx("input",{type:"date",className:"form-control",value:a.date_to,onChange:t=>i({...a,date_to:t.target.value}),style:{height:"38px",fontSize:"14px"}})]})}),e.jsx("div",{className:"col-md-3",children:e.jsxs("select",{className:"form-select",value:a.campaign,onChange:t=>i({...a,campaign:t.target.value}),style:{height:"38px"},children:[e.jsx("option",{value:"",children:"Select"}),l.campaigns.map(t=>e.jsx("option",{value:t.value,children:t.label},t.value))]})}),e.jsx("div",{className:"col-md-3",children:e.jsxs("select",{className:"form-select",value:a.telecaller,onChange:t=>i({...a,telecaller:t.target.value}),style:{height:"38px"},children:[e.jsx("option",{value:"",children:"Select"}),l.telecallers.map(t=>e.jsx("option",{value:t.value,children:t.label},t.value))]})}),e.jsx("div",{className:"col-md-3",children:e.jsxs("select",{className:"form-select",value:a.statusname,onChange:t=>i({...a,statusname:t.target.value}),style:{height:"38px"},children:[e.jsx("option",{value:"",children:"Select"}),l.statuses.map(t=>e.jsx("option",{value:t.value,children:t.label},t.value))]})})]})}),e.jsx("div",{className:"col-12",children:e.jsx("div",{className:"row",children:e.jsx("div",{className:"col-md-12",children:e.jsxs("div",{className:"d-flex gap-2",children:[e.jsx("button",{className:"btn btn-primary",onClick:d,style:{padding:"6px 20px",fontSize:"14px",fontWeight:"500"},children:"Submit"}),e.jsx("button",{className:"btn btn-secondary",onClick:m,style:{padding:"6px 20px",fontSize:"14px",fontWeight:"500"},children:"Reset"})]})})})})]})})}),R=({leads:a,isLoading:l,pagination:n,onPageChange:i,onRowsPerPageChange:r})=>{const{mode:d}=E(),m=d==="dark",[t,b]=u.useState(!1);u.useEffect(()=>{if(l)b(!0);else{const c=setTimeout(()=>b(!1),2e3);return()=>clearTimeout(c)}},[l]);const o=Array.from({length:n.per_page||10}).map((c,f)=>({leadmid:f,prospectname:"",mobile:"",campaign:"",telecaller:"",statusname:"",statusdate:"",created_at:""})),p=c=>{if(!c)return"";const f=new Date(c);return isNaN(f.getTime())?"":v(f,"dd-MM-yyyy")},s=()=>e.jsx("div",{className:"placeholder-wave w-100",children:e.jsx("span",{className:"placeholder col-12",style:{height:"20px",display:"block",borderRadius:"4px"}})}),g=[{name:"Sr.No",cell:(c,f)=>t?e.jsx(s,{}):f+1+(n.current_page-1)*n.per_page,width:"80px",center:!0},{name:"Campaign",cell:c=>t?e.jsx(s,{}):c.campaign,sortable:!0},{name:"User",cell:c=>t?e.jsx(s,{}):c.telecaller,sortable:!0},{name:"Lead Name",cell:c=>t?e.jsx(s,{}):c.prospectname,sortable:!0},{name:"Mobile",cell:c=>t?e.jsx(s,{}):c.mobile,center:!0},{name:"Status",cell:c=>t?e.jsx(s,{}):c.statusname,sortable:!0},{name:"Status Date",cell:c=>t?e.jsx(s,{}):p(c.statusdate),sortable:!0,center:!0},{name:"Added On",cell:c=>t?e.jsx(s,{}):p(c.created_at),sortable:!0,center:!0}],j={headCells:{style:{backgroundColor:m?"#1a1a1a":"#f8f9fa",color:m?"#ccc":"#333",fontWeight:600,fontSize:"14px",borderBottom:m?"2px solid #333":"2px solid #dee2e6",padding:"12px 15px"}},cells:{style:{fontSize:"14px",color:m?"#ccc":"#333",backgroundColor:m?"#1a1a1a":"#f8f9fa",padding:"12px 15px",borderBottom:m?"1px solid #333":"1px solid #dee2e6"}}};return e.jsx(P,{columns:g,data:t?o:a,customStyles:j,striped:!0,highlightOnHover:!0,noDataComponent:e.jsxs("div",{className:"text-center py-5",children:[e.jsx("i",{className:"bi bi-inbox display-4 text-muted mb-3"}),e.jsx("p",{className:"text-muted",children:"No data available in table"})]})})},M=({onExportExcel:a,onExportPDF:l,dataCount:n,leads:i,filters:r})=>{const d=()=>i.map((o,p)=>({"Sr.No":p+1,Campaign:o.campaign||"",User:o.telecaller||"","Lead Name":o.prospectname||"",Mobile:o.mobile||"",Status:o.statusname||"","Status Date":o.statusdate?v(new Date(o.statusdate),"dd-MM-yyyy HH:mm"):"","Added On":o.created_at?v(new Date(o.created_at),"dd-MM-yyyy"):"","Lead ID":o.leadmid||""})),m=()=>{if(n===0){alert("No data to export!");return}try{const o=d(),p=w.book_new(),s=w.json_to_sheet(o),g=[];o.forEach(S=>{Object.values(S).forEach((_,h)=>{const y=String(_).length;g[h]=Math.max(g[h]||0,y)})}),s["!cols"]=g.map(S=>({wch:Math.min(S+2,50)})),w.book_append_sheet(p,s,"Status Wise Leads");const c=b("xlsx"),f=$(p,{bookType:"xlsx",type:"array"}),N=new Blob([f],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});C.saveAs(N,c),a()}catch(o){console.error("Error exporting to Excel:",o),alert("Failed to export to Excel. Please try again.")}},t=()=>{if(n===0){alert("No data to export!");return}try{const o=d();let p=`
        <html>
        <head>
          <title>Status Wise Leads Report</title>
          <style>
            body { font-family: Arial, sans-serif; margin: 20px; }
            h1 { color: #333; font-size: 20px; margin-bottom: 20px; }
            h2 { color: #666; font-size: 14px; margin-bottom: 20px; }
            table { width: 100%; border-collapse: collapse; margin-top: 20px; }
            th { background-color: #f8f9fa; color: #333; font-weight: 600; 
                  padding: 10px; border: 1px solid #dee2e6; text-align: left; }
            td { padding: 8px 10px; border: 1px solid #dee2e6; }
            .footer { margin-top: 30px; font-size: 12px; color: #666; text-align: center; }
            .filter-info { background-color: #f8f9fa; padding: 10px; border-radius: 4px; margin-bottom: 20px; }
            .filter-item { margin-right: 15px; display: inline-block; }
          </style>
        </head>
        <body>
          <h1>Status Wise Leads Report</h1>
          
          <div class="filter-info">
            <strong>Report Filters:</strong><br/>
            <span class="filter-item">Date: ${r.date_from} to ${r.date_to}</span>
            ${r.campaign?`<span class="filter-item">Campaign: ${r.campaign}</span>`:""}
            ${r.telecaller?`<span class="filter-item">User: ${r.telecaller}</span>`:""}
            ${r.statusname?`<span class="filter-item">Status: ${r.statusname}</span>`:""}
            <span class="filter-item">Total Records: ${n}</span>
          </div>
          
          <table>
            <thead>
              <tr>
                ${Object.keys(o[0]||{}).map(g=>`<th>${g}</th>`).join("")}
              </tr>
            </thead>
            <tbody>
              ${o.map(g=>`
                <tr>
                  ${Object.values(g).map(j=>`<td>${j}</td>`).join("")}
                </tr>
              `).join("")}
            </tbody>
          </table>
          
          <div class="footer">
            Generated on: ${v(new Date,"dd-MM-yyyy HH:mm")}<br/>
            Â© 2025 Arth Technology
          </div>
        </body>
        </html>
      `;const s=window.open("","_blank");s&&(s.document.write(p),s.document.close(),s.print(),s.onafterprint=()=>s.close()),l()}catch(o){console.error("Error exporting to PDF:",o),alert("Failed to export to PDF. Please try again.")}},b=o=>{const p=v(new Date,"dd-MM-yyyy"),s=[r.campaign?`_${r.campaign}`:"",r.telecaller?`_${r.telecaller}`:"",r.statusname?`_${r.statusname}`:""].join("");return`Status_Wise_Leads_${p}${s}.${o}`};return e.jsxs("div",{className:"mt-4",children:[e.jsxs("div",{className:"d-flex gap-2",children:[e.jsxs("button",{className:"btn btn-success d-flex align-items-center gap-2",onClick:m,style:{padding:"8px 20px",fontSize:"14px",fontWeight:"500"},disabled:n===0,title:n===0?"No data to export":"Export to Excel",children:[e.jsx("i",{className:"bi bi-file-earmark-excel"}),"Export to Excel"]}),e.jsxs("button",{className:"btn btn-danger d-flex align-items-center gap-2",onClick:t,style:{padding:"8px 20px",fontSize:"14px",fontWeight:"500"},disabled:n===0,title:n===0?"No data to export":"Export to PDF",children:[e.jsx("i",{className:"bi bi-file-earmark-pdf"}),"Export PDF"]})]}),n>0&&e.jsxs("div",{className:"mt-2 text-muted",style:{fontSize:"12px"},children:["Export will include ",n," records"]})]})},A=({from:a,to:l,total:n,currentPage:i,totalPages:r})=>e.jsxs("div",{className:"d-flex justify-content-between align-items-center mt-3",children:[e.jsxs("div",{style:{fontSize:"14px",color:"#666"},children:["Showing ",a||0," to ",l||0," of ",n," entries"]}),e.jsxs("div",{style:{fontSize:"14px",color:"#666"},children:["Page ",i," of ",r]})]}),B=()=>{const{mode:a}=E(),[l,n]=u.useState({leadmids:[14401,14406],page:1,per_page:10,date_from:"2025-12-01",date_to:"2025-12-01",campaign:"",telecaller:"",statusname:""}),[i,r]=u.useState({campaigns:[],telecallers:[],statuses:[]}),{leads:d,isLoading:m,pagination:t,refetch:b}=F(l);u.useEffect(()=>{if(d.length>0){const h=Array.from(new Set(d.map(x=>x.campaign))).filter(Boolean),y=Array.from(new Set(d.map(x=>x.telecaller))).filter(Boolean),k=Array.from(new Set(d.map(x=>x.statusname))).filter(Boolean);r({campaigns:h.map(x=>({value:x,label:x})),telecallers:y.map(x=>({value:x,label:x})),statuses:k.map(x=>({value:x,label:x}))})}},[d]);const o=h=>n(h),p=h=>{},s=h=>n(y=>({...y,page:h})),g=h=>n(y=>({...y,per_page:h,page:1})),j=()=>n({leadmids:[14401,14406],page:1,per_page:10,date_from:"2025-12-01",date_to:"2025-12-01",campaign:"",telecaller:"",statusname:""}),c=()=>console.log("Export to Excel"),f=()=>console.log("Export to PDF"),N={padding:"20px",minHeight:"100vh",background:a==="dark"?"#141414":"#f8f9fa",color:a==="dark"?"#fff":"#000"},S={borderRadius:"4px",background:a==="dark"?"#1f1f1f":"#fff"},_={background:a==="dark"?"#1a1a1a":"#fff",borderBottom:"1px solid #dee2e6",padding:"15px 20px"};return e.jsx("div",{className:"container-fluid ",style:N,children:e.jsxs("div",{className:"card",style:S,children:[e.jsx("div",{className:"card-header",style:_,children:e.jsx("h1",{className:"fw-bold text-gray-800 mt-5",children:"Status Wise Lead"})}),e.jsxs("div",{className:"card-body",style:{padding:20},children:[e.jsx(L,{filters:l,filterOptions:i,dateRange:[new Date(l.date_from),new Date(l.date_to)],onFilterChange:o,onDateChange:p,onApplyFilters:b,onResetFilters:j}),e.jsx(R,{leads:d,isLoading:m,pagination:t,onPageChange:s,onRowsPerPageChange:g}),e.jsx(A,{from:t.from,to:t.to,total:t.total,currentPage:t.current_page,totalPages:Math.ceil(t.total/t.per_page)}),e.jsx(M,{onExportExcel:c,onExportPDF:f,dataCount:d.length,leads:d,filters:{date_from:l.date_from,date_to:l.date_to,campaign:l.campaign,telecaller:l.telecaller,statusname:l.statusname}})]})]})})};export{B as default};
