import{r as d,j as e,S as N,G as U,H as B,I as q,J as G}from"./index-BJcvY-Fc.js";const H=({show:n,onClose:i,mode:l,campaignName:h,setCampaignName:a,campaignDate:r,setCampaignDate:b,onSubmit:g})=>{const u=l==="add"?"Create New Campaign":"Edit Campaign",f=l==="add"?"Create Campaign":"Update Campaign",o=l==="add"?"bi-plus-circle":"bi-pencil-square",C=h.trim()&&r.trim();return d.useEffect(()=>{if(l==="add"&&!r){const m=new Date().toISOString().split("T")[0];b(m)}},[l,r,b]),e.jsx("div",{className:`modal fade ${n?"show d-block":""}`,style:{backgroundColor:"rgba(0,0,0,0.5)"},children:e.jsx("div",{className:"modal-dialog modal-dialog-centered",children:e.jsxs("div",{className:"modal-content",children:[e.jsxs("div",{className:"modal-header",children:[e.jsxs("h5",{className:"modal-title",children:[e.jsx("i",{className:"bi bi-megaphone me-2"}),u]}),e.jsx("button",{type:"button",className:"btn-close",onClick:i})]}),e.jsxs("div",{className:"modal-body",children:[e.jsxs("div",{className:"mb-3",children:[e.jsxs("label",{htmlFor:"campaignName",className:"form-label",children:["Campaign Name ",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsx("input",{type:"text",className:"form-control form-control-lg",id:"campaignName",value:h,onChange:m=>a(m.target.value),placeholder:"Enter campaign name..."})]}),e.jsxs("div",{className:"mb-3",children:[e.jsxs("label",{htmlFor:"campaignDate",className:"form-label",children:["Campaign Date ",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsx("input",{type:"date",className:"form-control form-control-lg",id:"campaignDate",value:r,onChange:m=>b(m.target.value)})]})]}),e.jsxs("div",{className:"modal-footer",children:[e.jsxs("button",{type:"button",className:"btn btn-outline-secondary",onClick:i,children:[e.jsx("i",{className:"bi bi-x-circle me-1"})," Cancel"]}),e.jsxs("button",{type:"button",className:"btn btn-primary",onClick:g,disabled:!C,children:[e.jsx("i",{className:`bi ${o} me-1`})," ",f]})]})]})})})},J=()=>e.jsx("div",{className:"card shadow-sm",children:e.jsx("div",{className:"card-body p-0",children:e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table table-bordered table-hover mb-0",children:[e.jsx("thead",{className:"bg-secondary text-white",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-uppercase font-sm text-muted",children:"#"}),e.jsx("th",{className:"px-4 py-3 text-uppercase font-sm text-muted",children:"Campaign Name"}),e.jsx("th",{className:"px-4 py-3 text-uppercase font-sm text-muted",children:"Campaign Date"}),e.jsx("th",{className:"px-4 py-3 text-uppercase font-sm text-muted",children:"Operations"})]})}),e.jsx("tbody",{children:[...Array(5)].map((n,i)=>e.jsxs("tr",{className:"align-middle",children:[e.jsx("td",{className:"px-4 py-3",children:e.jsx(N.Input,{active:!0,size:"small",style:{width:30}})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(N.Input,{active:!0,size:"small",style:{width:140}})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx(N.Input,{active:!0,size:"small",style:{width:100}})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"d-flex gap-2",children:[e.jsx(N.Button,{active:!0,size:"small",style:{width:70}}),e.jsx(N.Button,{active:!0,size:"small",style:{width:70}})]})})]},i))})]})})})}),R=({campaigns:n,onEdit:i,onDelete:l,loading:h=!1})=>h?e.jsx(J,{}):e.jsx("div",{className:"card shadow-sm",children:e.jsxs("div",{className:"card-body p-0",children:[e.jsx("div",{className:"d-none d-lg-block",children:e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table table-bordered table-hover mb-0",children:[e.jsx("thead",{className:"bg-secondary text-white",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-uppercase font-sm text-bold",children:"Sr.No"}),e.jsx("th",{className:"px-4 py-3 text-uppercase font-sm text-bold",children:"Campaign Name"}),e.jsx("th",{className:"px-4 py-3 text-uppercase font-sm text-bold",children:"Campaign Date"}),e.jsx("th",{className:"px-4 py-3 text-uppercase font-sm text-bold",children:"Operations"})]})}),e.jsx("tbody",{children:n.length>0?n.map((a,r)=>e.jsxs("tr",{className:"align-middle",children:[e.jsx("td",{className:"px-4 py-3 fw-semibold",children:r+1}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:"badge bg-light text-dark fs-6",children:a.name})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:"text-muted",children:new Date(a.date).toLocaleDateString()})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"btn-group btn-group-sm",role:"group",children:[e.jsxs("button",{className:"btn btn-outline-success",onClick:()=>i(a),children:[e.jsx("i",{className:"bi bi-pencil"})," Edit"]}),e.jsxs("button",{className:"btn btn-outline-danger",onClick:()=>l(a.id),children:[e.jsx("i",{className:"bi bi-trash"})," Delete"]})]})})]},a.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:4,className:"text-center py-15",children:e.jsxs("div",{className:"d-flex flex-column align-items-center",children:[e.jsx("i",{className:"bi bi-megaphone fs-2x text-gray-400 mb-3"}),e.jsx("span",{className:"text-gray-600 fs-5 fw-semibold mb-2",children:"No campaigns found"}),e.jsx("span",{className:"text-muted fs-7",children:"Try adjusting your search or add a new campaign"})]})})})})]})})}),e.jsx("div",{className:"d-lg-none",children:n.length===0?e.jsxs("div",{className:"text-center py-10",children:[e.jsx("i",{className:"bi bi-megaphone fs-2x text-muted mb-2"}),e.jsx("span",{className:"text-muted fs-6 d-block",children:"No campaigns found"})]}):e.jsx("div",{className:"row g-3 p-3",children:n.map((a,r)=>e.jsx("div",{className:"col-12",children:e.jsx("div",{className:"card card-flat border",children:e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"d-flex justify-content-between align-items-start mb-3",children:[e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx("div",{className:"symbol symbol-50px symbol-circle me-3 bg-light-primary",children:e.jsx("div",{className:"symbol-label text-primary",children:e.jsx("i",{className:"bi bi-megaphone fs-4"})})}),e.jsxs("div",{children:[e.jsx("span",{className:"fw-bold text-gray-800",children:a.name}),e.jsxs("span",{className:"text-muted fs-7 d-block",children:["#",r+1]})]})]}),e.jsxs("div",{className:"dropdown",children:[e.jsx("button",{className:"btn btn-sm btn-light",type:"button","data-bs-toggle":"dropdown",children:e.jsx("i",{className:"bi bi-three-dots-vertical"})}),e.jsxs("ul",{className:"dropdown-menu",children:[e.jsx("li",{children:e.jsxs("button",{className:"dropdown-item",onClick:()=>i(a),children:[e.jsx("i",{className:"bi bi-pencil me-2"}),"Edit"]})}),e.jsx("li",{children:e.jsxs("button",{className:"dropdown-item text-danger",onClick:()=>l(a.id),children:[e.jsx("i",{className:"bi bi-trash me-2"}),"Delete"]})})]})]})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("small",{className:"text-muted",children:"Campaign Date"}),e.jsx("div",{className:"fw-semibold",children:new Date(a.date).toLocaleDateString()})]}),e.jsxs("div",{className:"row g-2",children:[e.jsx("div",{className:"col-6",children:e.jsxs("button",{className:"btn btn-outline-success btn-sm w-100",onClick:()=>i(a),children:[e.jsx("i",{className:"bi bi-pencil me-1"}),"Edit"]})}),e.jsx("div",{className:"col-6",children:e.jsxs("button",{className:"btn btn-outline-danger btn-sm w-100",onClick:()=>l(a.id),children:[e.jsx("i",{className:"bi bi-trash me-1"}),"Delete"]})})]})]})})},a.id))})})]})}),K=()=>{const[n,i]=d.useState(1),[l,h]=d.useState(10),[a,r]=d.useState({current_page:1,per_page:10,total_records:0,total_pages:1}),[b,g]=d.useState(!1),[u,f]=d.useState("add"),[o,C]=d.useState(""),[m,v]=d.useState(""),[E,P]=d.useState([]),[j,y]=d.useState(""),[w,_]=d.useState(null),[$,D]=d.useState(!1);d.useEffect(()=>{S()},[n,l,o]);const S=async()=>{D(!0);try{console.log("Fetching campaigns with page:",n,"per page:",l,"search:",o);const s=await U(n,l,o);console.log("Campaigns API response:",s),P(s.data),r({current_page:s.current_page,per_page:s.per_page,total_records:s.total_records,total_pages:s.total_pages})}catch(s){console.error("Error fetching campaigns:",s),P([])}finally{D(!1)}},A=s=>{const c=Number(s.target.value);h(c),i(1)},k=s=>{i(s)},I=s=>{const[c,x,t]=s.split("-");return`${t}-${x}-${c}`},L=async()=>{var c,x;if(!j.trim()){alert("Please enter a campaign name");return}if(!m){alert("Please select a date");return}const s=I(m);console.log("Date conversion:",{input:m,output:s});try{u==="add"?(console.log("Adding campaign:",{name:j,date:s}),await B(j,s)):u==="edit"&&w!==null&&(console.log("Updating campaign:",{id:w,name:j,date:s}),await q(w,j,s)),await S()}catch(t){console.error("Error saving campaign:",t);let p="Error saving campaign. Please try again.";(x=(c=t==null?void 0:t.response)==null?void 0:c.data)!=null&&x.message?p=t.response.data.message:t!=null&&t.message&&(p=t.message),alert(p);return}y(""),_(null),v(""),g(!1)},z=async s=>{var c,x;if(window.confirm("Are you sure you want to delete this campaign?"))try{console.log("Deleting campaign:",s),await G(s),await S(),E.length===1&&n>1&&i(n-1)}catch(t){console.error("Error deleting campaign:",t);let p="Error deleting campaign. Please try again.";(x=(c=t==null?void 0:t.response)==null?void 0:c.data)!=null&&x.message?p=t.response.data.message:t!=null&&t.message&&(p=t.message),alert(p)}},F=s=>{f("edit"),_(s.id),y(s.name),v(s.date),g(!0)},O=()=>{f("add"),y(""),v(""),_(null),g(!0)},T=s=>{const c=s.target.value;C(c),i(1)},M=E;return e.jsxs("div",{className:"container-fluid py-4",children:[e.jsxs("div",{className:"card shadow-sm",children:[e.jsxs("div",{className:"card-header bg-transparent py-3",children:[e.jsx("div",{className:"d-flex justify-content-between align-items-center",children:e.jsx("div",{children:e.jsx("h1",{className:"fw-bold text-gray-800",children:"Campaign Master"})})}),e.jsxs("button",{onClick:O,className:"btn btn-sm btn-primary d-flex align-items-center gap-2 mt-1",style:{width:"150px",height:"35px"},children:[e.jsx("i",{className:"bi bi-plus-circle"}),"Add Campaign"]})]}),e.jsxs("div",{className:"card-body",children:[e.jsx("div",{className:"card card-flat mb-4",children:e.jsx("div",{className:"card-body py-3",children:e.jsxs("div",{className:"row align-items-center",children:[e.jsx("div",{className:"col-md-6",children:e.jsxs("div",{className:"d-flex align-items-center gap-2",children:[e.jsx("label",{className:"form-label mb-0 text-muted",children:"Show"}),e.jsxs("select",{value:l,onChange:A,className:"form-select form-select-sm w-auto",children:[e.jsx("option",{value:"5",children:"5"}),e.jsx("option",{value:"10",children:"10"}),e.jsx("option",{value:"25",children:"25"}),e.jsx("option",{value:"50",children:"50"})]}),e.jsx("label",{className:"form-label mb-0 text-muted",children:"entries"})]})}),e.jsx("div",{className:"col-md-6",children:e.jsxs("div",{className:"d-flex align-items-center gap-2 justify-content-md-end",children:[e.jsx("label",{className:"form-label mb-0 text-muted",children:"Search:"}),e.jsxs("div",{className:"position-relative",children:[e.jsx("input",{type:"text",placeholder:"Search campaigns...",value:o,onChange:T,className:"form-control form-control-sm"}),e.jsx("i",{className:"bi bi-search position-absolute top-50 end-0 translate-middle-y me-2 text-muted"})]})]})})]})})}),e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-body p-0",children:e.jsx(R,{campaigns:M,onEdit:F,onDelete:z,loading:$})})}),e.jsx("div",{className:"card card-flat mt-4",children:e.jsx("div",{className:"card-body py-3",children:e.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[e.jsxs("div",{className:"text-muted small",children:["Showing ",M.length," of ",a.total_records," entries",o&&` (filtered from ${a.total_records} total entries)`]}),a.total_pages>1&&e.jsxs("div",{className:"d-flex align-items-center gap-3",children:[e.jsxs("div",{className:"text-muted small",children:["Page ",a.current_page," of ",a.total_pages]}),e.jsx("nav",{children:e.jsxs("ul",{className:"pagination pagination-sm mb-0",children:[e.jsx("li",{className:`page-item ${a.current_page===1?"disabled":""}`,children:e.jsx("button",{className:"page-link",onClick:()=>k(a.current_page-1),disabled:a.current_page===1,children:"Previous"})}),Array.from({length:a.total_pages},(s,c)=>c+1).map(s=>e.jsx("li",{className:`page-item ${a.current_page===s?"active":""}`,children:e.jsx("button",{className:"page-link",onClick:()=>k(s),children:s})},s)),e.jsx("li",{className:`page-item ${a.current_page===a.total_pages?"disabled":""}`,children:e.jsx("button",{className:"page-link",onClick:()=>k(a.current_page+1),disabled:a.current_page===a.total_pages,children:"Next"})})]})})]})]})})})]})]}),e.jsx(H,{show:b,onClose:()=>g(!1),mode:u,campaignName:j,setCampaignName:y,campaignDate:m,setCampaignDate:v,onSubmit:L})]})};export{K as default};
